(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{353:function(e,t,n){},356:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n(31),r=n(19),c=n(6),o=n.n(c),i=n(8),s=n(17),l=n(26),u=n(22),d=n(14),p=n(20),v=n(4),h=n(0),f=n.n(h),g=n(13),m=n(5),b=n(101),x=n.n(b),k=(n(350),n(351),n(27)),w=n.n(k),j=(n(352),n(353),n(354),n(38)),O=n(37);function y(){var e=Object(v.a)(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  min-width: 1080px;\n"]);return y=function(){return e},e}function S(){var e=Object(v.a)(["\n  width: 100%;\n  height: 100%;\n"]);return S=function(){return e},e}function C(){var e=Object(v.a)(["\n  position: absolute;\n  top: 0px;\n  left: 540px;\n  height: 31px;\n  overflow: hidden;\n  z-index: 2;\n"]);return C=function(){return e},e}var I=m.a.nav(C()),A=m.a.section(S()),D=m.a.main(y()),E=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).container=void 0,n.editor=void 0,n.PageContainer=void 0,n.articleId="",n.timer=null,n.saveArticleLocal=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.editor.getMarkdown(),e.prev=1,e.next=4,w.a.setItem("article",t);case 4:g.a.success("saved success!"),console.log("\u672c\u5730\u4fdd\u5b58\u6210\u529f"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),g.a.error("saved error!"),console.log("\u672c\u5730\u4fdd\u5b58\u5931\u8d25");case 12:case"end":return e.stop()}},e,null,[[1,8]])})),n.restoryArticeLocal=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.getItem("article");case 2:(t=e.sent)&&n.editor.mdEditor.setValue(t);case 4:case"end":return e.stop()}},e)})),n.getArticleDetail=Object(i.a)(o.a.mark(function e(){var t,a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.articleId){e.next=3;break}return n.restoryArticeLocal(),e.abrupt("return");case 3:return e.prev=4,e.next=7,j.a.getPostDetail({id:n.articleId});case 7:return t=e.sent,e.next=10,t.json();case 10:return a=e.sent,r=a.data.content,n.editor.mdEditor.setValue(r),e.abrupt("return",a);case 16:e.prev=16,e.t0=e.catch(4),console.log(e.t0);case 19:case"end":return e.stop()}},e,null,[[4,16]])})),n.saveClick=Object(i.a)(o.a.mark(function e(){var t,a,c,i,s,l,u,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.history,!n.state.loadStatus){e.next=4;break}return e.abrupt("return");case 4:if(n.setState({loadStatus:!0}),a=n.editor.getMarkdown(),c=a.match(/#\s?(\S*)\r?\s?/),i=c&&c[1],s=n.pickTagCatDate(a),e.prev=9,l=Object(r.a)({title:i,content:a,desc:""},s),console.log(l),!n.articleId){e.next=20;break}return e.next=15,j.a.patchPost(Object(r.a)({id:n.articleId},l));case 15:u=e.sent,t.goBack(),console.log(u),e.next=25;break;case 20:return e.next=22,j.a.postPost(l);case 22:d=e.sent,console.log(d),t.goBack();case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(9),Object(g.a)(e.t0.msg||"saved error"),console.log(e.t0);case 31:return e.prev=31,n.setState({loadStatus:!1}),e.finish(31);case 34:case"end":return e.stop()}},e,null,[[9,27,31,34]])})),n.pickTagCatDate=function(e){var t=e.match(/&{3}([\S\s]*)&{3}/),a=t&&t[1]||"";console.log(a);var r=a.split(/\r?\n/),c=[],o=[],i=+new Date;return r.forEach(function(e){""!==e&&(/tags/g.test(e)?c=n.resolveArrText("tags",e):/category/g.test(e)?o=n.resolveArrText("category",e):/date/g.test(e)&&(i=n.resolveText("date",e)))}),{tags:c,category:o,time:i}},n.resolveText=function(e,t){var n=t.replace("".concat(e,":"),"");return n=n.trim(),+new Date(n)},n.resolveArrText=function(e,t){var n=t.replace("".concat(e,":"),"").split(",");return n=n.map(function(e){return e.trim()}),Object(a.a)(new Set(Object(a.a)(n)))},console.log(e);var c=e.location.state;return c&&(n.articleId=c.id,console.log(c.id)),n.container=f.a.createRef(),n.PageContainer=f.a.createRef(),n.state={loadStatus:!1},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"componentDidMount",value:function(){var e=this.PageContainer.current.clientHeight;console.log(e),this.editor=new x.a({el:this.container.current,initialEditType:"markdown",previewStyle:"vertical",height:"".concat(e,"px"),hideModeSwitch:!0,initialValue:"",codeBlockLanguages:["javascript","bash","nginx","docker","typescript","html","css"]});var t=setInterval(this.saveArticleLocal,6e4);this.timer=t,console.log(this.editor),this.getArticleDetail(),this.editor.on("load",function(e){}),this.editor.on("focus",function(e){}),this.editor.on("change",function(e){})}},{key:"render",value:function(){return f.a.createElement(D,{ref:this.PageContainer},f.a.createElement(I,null,f.a.createElement(O.a,{load:this.state.loadStatus,onClick:this.saveClick})),f.a.createElement(A,{ref:this.container}),">")}}]),t}(h.Component)}}]);
//# sourceMappingURL=4.2226c887.chunk.js.map