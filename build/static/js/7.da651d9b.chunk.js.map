{"version":3,"sources":["pages/Home.tsx","utils/categoryManage.ts"],"names":["PageContainer","styled","main","_templateObject","GridBox","div","_templateObject2","prop","show","GridA","_templateObject3","GridB","_templateObject4","GridC","_templateObject5","GridD","_templateObject6","GridDRight","_templateObject7","AvatarBox","_templateObject8","FormBox","_templateObject9","CardList","props","history","_useState","useState","_useState2","Object","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","cards","setCards","_useState3","_useState4","cardContentData","setCardContent","_useState5","_useState6","showContent","setShowContent","_useState7","_useState8","selectIndex","setSelectIndex","_useState9","_useState10","categorys","setCategorys","_useState11","_useState12","categoryShow","setCategoryShow","_useState13","_useState14","loginShow","setLoginShow","_useState15","_useState16","loginFormType","setLoginFormType","_useState17","_useState18","loginStatus","setLoginStatus","saveCategoryForLocal","_ref","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","a","mark","_callee","category","categorysLocal","wrap","_context","prev","next","localForage","getItem","sent","push","setItem","stop","_x","apply","this","arguments","addCategoryList","newCategorys","currCategorys","concat","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","length","saveCategory","_ref2","_callee2","len","_context2","_x2","setCurrCategoryCards","_ref4","_callee4","_context4","_x4","getCategorysFromLocal","_ref5","_callee5","_context5","categoryManage","getListFromLocal","categoryDel","_ref7","_callee7","index","currCategory","_categorys","_context7","removeLocalByUlid","ulid","_x6","categorySync","_ref8","_callee8","_context8","syncCardsByUlid","_x7","useEffect","console","log","react__WEBPACK_IMPORTED_MODULE_5___default","createElement","components__WEBPACK_IMPORTED_MODULE_8__","onSelect","onDel","onSync","onHide","onSuccess","type","name","onClick","onClickLogin","onClickSignIn","assign","close","itemClick","item","onSave","pathname","state","toast","error","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","abrupt","getLocalByUlid","categoryLocal","_callee3","_context3","_index","findIndex","val","splice","find","repaceCategoryByUlid","_callee6","newCategory","_categoryIndex","_context6","serverPromise","serverData","serverCategory","Api","syncCategory","json","data","card","__webpack_exports__","getLocalCardsByUlid","removeCardsByUlid","addCardByUlid"],"mappings":"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","file":"static/js/7.da651d9b.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport styled from 'styled-components';\nimport localForage from 'localforage';\nimport {\n  CardContent,\n  CustomButton,\n  CardsHorz,\n  CategoryList,\n  CategoryForm,\n  LoginForm,\n  Avatar,\n} from 'components';\nimport { ItemData, CategoryData } from 'types';\nimport categoryManage from 'utils/categoryManage';\nimport { toast } from 'react-toastify';\n\nconst PageContainer = styled.main`\n  width: 100vw;\n  height: 100vh;\n  background: #000;\n  position: relative;\n`;\nconst GridBox = styled.div`\n  width: 100%;\n  height: 100%;\n  display: grid;\n  overflow: hidden;\n  grid-template-columns: 200px 1fr;\n  grid-template-rows: ${(prop: any) =>\n    prop.show ? '120px 1fr 120px' : '1fr 300px 1fr'};\n  grid-template-areas: 'a b' 'a c' 'a d';\n  transition: all 2s;\n`;\nconst GridA = styled.div`\n  grid-area: a;\n`;\nconst GridB = styled.div`\n  grid-area: b;\n  border-left: 2px solid var(--color-3);\n  border-bottom: 2px solid var(--color-3);\n  box-shadow: 0 0 10px 0 var(--color-3) inset;\n  border-bottom-left-radius: 10px;\n  overflow: hidden;\n  display: flex;\n`;\nconst GridC = styled.div`\n  width: 100%;\n  min-width: 100%;\n  grid-area: c;\n`;\nconst GridD = styled.div`\n  grid-area: d;\n  border-left: 2px solid var(--color-3);\n  border-top: 2px solid var(--color-3);\n  box-shadow: 0 0 10px 0 var(--color-3) inset;\n  border-top-left-radius: 10px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px;\n`;\nconst GridDRight = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n`;\nconst AvatarBox = styled.div`\n  margin: 0 100px;\n`;\n\nconst FormBox = styled.div`\n  border-top-left-radius: 10px;\n  height: 100%;\n  width: ${(prop: any) => (prop.show ? '300px' : '0')};\n  overflow: hidden;\n  transform: ${(prop: any) =>\n    prop.show ? 'translateX(0)' : 'translateX(-120%)'};\n  transition: transform 0.5s;\n`;\nconst CardList = (props: RouteComponentProps) => {\n  const { history } = props;\n  const [cards, setCards] = useState();\n  const [cardContentData, setCardContent] = useState();\n  const [showContent, setShowContent] = useState(false);\n  const [selectIndex, setSelectIndex] = useState(-1);\n  const initCaregeorys: CategoryData[] = [];\n  const [categorys, setCategorys] = useState(initCaregeorys);\n  const [categoryShow, setCategoryShow] = useState(false);\n  const [loginShow, setLoginShow] = useState(false);\n  const [loginFormType, setLoginFormType] = useState('login');\n  const [loginStatus, setLoginStatus] = useState(false);\n  const itemClick = (item: ItemData) => {\n    console.log(item);\n    setShowContent(true);\n    setCardContent(item);\n  };\n  const createCategory = () => {\n    console.log('新建分类');\n    setCategoryShow(true);\n  };\n  const createCard = () => {\n    const currCategory = categorys[selectIndex];\n    if (currCategory) {\n      history.push({\n        pathname: 'editor',\n        state: { category: currCategory.ulid, type: currCategory.type },\n      });\n    } else {\n      toast.error('请先新建分类');\n    }\n  };\n  const saveCategoryForLocal = async (category: CategoryData) => {\n    let categorysLocal: CategoryData[] = await localForage.getItem('categorys');\n    if (categorysLocal) {\n      categorysLocal.push(category);\n    } else {\n      categorysLocal = [category];\n    }\n    await localForage.setItem('categorys', categorysLocal);\n  };\n  const addCategoryList = (newCategorys: CategoryData[]) => {\n    const currCategorys = [...categorys, ...newCategorys];\n    setCategorys(currCategorys);\n    return currCategorys.length;\n  };\n  const saveCategory = async (category: CategoryData) => {\n    await saveCategoryForLocal(category);\n    const len = addCategoryList([category]);\n    setSelectIndex(len - 1);\n    setCategoryShow(false);\n  };\n  const hideCategoryForm = () => {\n    setCategoryShow(false);\n  };\n  const getCardsFromLocal = async (category: CategoryData) => {\n    const localCards: any[] = await categoryManage.getLocalCardsByUlid(\n      category.ulid\n    );\n    return localCards;\n  };\n  const setCurrCategoryCards = async (category: CategoryData) => {\n    if (category.cards) {\n      setCards(category.cards);\n    }\n  };\n  const getCategorysFromLocal = async () => {\n    let categorysLocal: CategoryData[] = await categoryManage.getListFromLocal();\n    if (categorysLocal.length > 0) {\n      addCategoryList(categorysLocal);\n      setSelectIndex(0);\n    }\n  };\n  const getCategoryFromLocal = async (ulid: string) => {\n    let categorysLocal: CategoryData[] = await localForage.getItem(ulid);\n    return categorysLocal || [];\n  };\n  const categorySelect = (index: number) => {\n    console.log(index);\n    setCardContent('');\n    setSelectIndex(index);\n    // getCardsFromLocal(categorys[index]);\n  };\n  const categoryDel = async (index: number) => {\n    const currCategory = categorys[index];\n    if (currCategory) {\n      const _categorys = await categoryManage.removeLocalByUlid(\n        currCategory.ulid\n      );\n      if (_categorys) {\n        setCategorys(_categorys);\n        setSelectIndex(index - 1);\n      }\n    }\n  };\n  const categorySync = async (index: number) => {\n    const currCategory = categorys[index];\n    categoryManage.syncCardsByUlid(currCategory.ulid);\n  };\n  const removeLocalCards = async () => {\n    console.log('remove');\n  };\n  const loginOrSignInSuccess = () => {\n    setLoginStatus(true);\n  };\n  const showLogin = () => {\n    setLoginFormType('login');\n    setLoginShow(true);\n  };\n  const showSignin = () => {\n    setLoginFormType('signin');\n    setLoginShow(true);\n  };\n  const hasLogin = () => {\n    const token = localForage.getItem('token');\n    if (token) {\n      setLoginStatus(true);\n    }\n  };\n  const hideLoginForm = () => {\n    setLoginShow(false);\n  };\n  const toSearchList = () => {\n    history.push('/list');\n  };\n  useEffect(() => {\n    getCategorysFromLocal();\n    hasLogin();\n  }, []);\n  useEffect(() => {\n    const currCategory = categorys[selectIndex];\n    console.log(currCategory);\n    if (currCategory) {\n      setCurrCategoryCards(currCategory);\n    }\n  }, [selectIndex]);\n  return (\n    <PageContainer>\n      <GridBox show={showContent}>\n        <GridA>\n          <CategoryList\n            categorys={categorys}\n            selectIndex={selectIndex}\n            onSelect={categorySelect}\n            onDel={categoryDel}\n            onSync={categorySync}\n          />\n        </GridA>\n        <GridB>\n          <FormBox show={loginShow}>\n            <LoginForm\n              onHide={hideLoginForm}\n              onSuccess={loginOrSignInSuccess}\n              type={loginFormType}\n            />\n          </FormBox>\n          <GridDRight>\n            {!loginShow && <CustomButton name='搜索' onClick={toSearchList} />}\n            <AvatarBox>\n              <Avatar\n                onClickLogin={showLogin}\n                onClickSignIn={showSignin}\n                loginStatus={loginStatus}\n              />\n            </AvatarBox>\n          </GridDRight>\n        </GridB>\n        <GridC>\n          {showContent ? (\n            <CardContent\n              {...cardContentData}\n              close={() => setShowContent(false)}\n            />\n          ) : (\n            <CardsHorz cards={cards} itemClick={itemClick} />\n          )}\n        </GridC>\n        <GridD>\n          <FormBox show={categoryShow}>\n            <CategoryForm onSave={saveCategory} onHide={hideCategoryForm} />\n          </FormBox>\n          <GridDRight>\n            <CustomButton name='新建分类' onClick={createCategory} />\n            <CustomButton name='新建卡片' onClick={createCard} />\n          </GridDRight>\n        </GridD>\n      </GridBox>\n    </PageContainer>\n  );\n};\nexport default CardList;\n","import localForage from 'localforage';\nimport { CardData, CategoryData } from '../types';\nimport Api from 'api';\n\nasync function getListFromLocal() {\n  const categorysLocal: CategoryData[] = await localForage.getItem('categorys');\n  return categorysLocal || [];\n}\nasync function getLocalByUlid(ulid: string) {\n  const categoryLocal: CategoryData = await localForage.getItem(ulid);\n  return categoryLocal;\n}\nasync function getLocalCardsByUlid(ulid: string) {\n  const categoryLocal: CategoryData = await getLocalByUlid(ulid);\n  console.log(categoryLocal);\n  return (categoryLocal && categoryLocal.cards) || [];\n}\nasync function removeLocalByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const _index = categorysLocal.findIndex(val => val.ulid === ulid);\n  if (_index > -1) {\n    categorysLocal.splice(_index, 1);\n    await localForage.setItem('categorys', categorysLocal);\n    return categorysLocal;\n  }\n  return null;\n}\nasync function removeCardsByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    currCategory.cards = [];\n    await localForage.setItem('categorys', categorysLocal);\n  }\n}\nasync function repaceCategoryByUlid(\n  ulid: string,\n  newCategory: CategoryData,\n  categorys?: CategoryData[]\n) {\n  let _categorys = categorys;\n  if (!categorys) {\n    _categorys = await getListFromLocal();\n  }\n  if (_categorys) {\n    const _categoryIndex = _categorys.findIndex(val => val.ulid === ulid);\n    if (_categoryIndex > -1) {\n      _categorys[_categoryIndex] = newCategory;\n      await localForage.setItem('categorys', _categorys);\n    }\n  }\n}\n/**\n * 和服务器同步卡片，只同步本人创建的分类\n *\n * @param {string} ulid 分类uLid\n */\nasync function syncCardsByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    const serverPromise = await Api.syncCategory(currCategory);\n    const serverData = await serverPromise.json();\n    const serverCategory = serverData.data;\n    if (serverCategory) {\n      await repaceCategoryByUlid(ulid, serverCategory, categorysLocal);\n    }\n  }\n}\n/**\n * 通过ulid添加卡片到本地\n *\n * @param {string} ulid\n * @param {CardData} card\n * @returns\n */\nasync function addCardByUlid(ulid: string, card: CardData) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    currCategory.cards.push(card);\n    await localForage.setItem('categorys', categorysLocal);\n  } else {\n    return null;\n  }\n}\nexport default {\n  getListFromLocal,\n  getLocalByUlid,\n  getLocalCardsByUlid,\n  removeLocalByUlid,\n  removeCardsByUlid,\n  syncCardsByUlid,\n  addCardByUlid,\n};\n"],"sourceRoot":""}