{"version":3,"sources":["pages/CardEditor.tsx"],"names":["PageContainer","styled","main","_templateObject","MainContainer","div","_templateObject2","CardFormContainer","header","_templateObject3","EditorContainer","section","_templateObject4","FooterContainer","footer","_templateObject5","CardEditor","props","_this","Object","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","this","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__","call","container","editor","title","desc","category","tags","cardType","prevCategory","timer","saveCardForCategory","_ref","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","card","wrap","_context","prev","next","categoryManage","addCardByUlid","toast","success","stop","_x","apply","arguments","saveCard","_callee2","_assertThisInitialize","content","_tags","_ulid","_context2","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__","getMarkdown","console","log","error","abrupt","split","generateUlid","authName","type","ulid","date","Date","toHome","history","goBack","titleHandler","e","target","value","descHandler","tagsHandler","state","location","React","createRef","loadStatus","clearInterval","Editor","el","current","initialEditType","previewStyle","height","concat","hideModeSwitch","initialValue","codeBlockLanguages","react__WEBPACK_IMPORTED_MODULE_9___default","createElement","components__WEBPACK_IMPORTED_MODULE_18__","defaultCategory","ref","text","onClick","Component"],"mappings":"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","file":"static/js/6.9b08e4ca.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport styled from 'styled-components';\nimport Editor from 'tui-editor';\nimport 'tui-editor/dist/tui-editor.css';\nimport 'tui-editor/dist/tui-editor-contents.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'styles/pages/Editor.css';\nimport 'highlight.js/styles/atelier-lakeside-dark.css';\nimport { CardForm, SaveButton } from 'components';\n// import { async } from 'q';\nimport { CardData } from 'types';\nimport categoryManage from 'utils/categoryManage';\nimport generateUlid from 'utils/generateUlid';\n\nconst PageContainer = styled.main`\n  width: 100%;\n  height: 100%;\n  background: var(--color-1);\n`;\nconst MainContainer = styled.div`\n  position: relative;\n  min-width: 800px;\n  max-width: 1080px;\n  margin: 0 auto;\n`;\nconst CardFormContainer = styled.header`\n  width: 100%;\n  padding-top: 10px;\n`;\nconst EditorContainer = styled.section`\n  width: 100%;\n  height: 100%;\n  background: #fff;\n`;\nconst FooterContainer = styled.footer`\n  height: 80px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\ninterface State {\n  loadStatus?: boolean;\n}\n\nexport default class CardEditor extends Component<RouteComponentProps, State> {\n  private container: any;\n  private editor: any;\n  private title: string = '';\n  private desc: string = '';\n  private category: string = '';\n  private tags: string = '';\n  private cardType: string = 'custom';\n  private prevCategory: string = '';\n  private timer: NodeJS.Timeout | null = null;\n  constructor(props: RouteComponentProps) {\n    super(props);\n    console.log(props);\n    const { state } = props.location;\n    const { category, type } = state;\n    this.category = category;\n    this.cardType = type;\n    this.container = React.createRef();\n    this.state = {\n      loadStatus: false,\n    };\n  }\n  componentWillUnmount() {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n  }\n  componentDidMount() {\n    this.editor = new Editor({\n      el: this.container.current,\n      initialEditType: 'markdown',\n      previewStyle: 'vertical',\n      height: `${600}px`,\n      hideModeSwitch: true,\n      initialValue: '',\n      codeBlockLanguages: [\n        'javascript',\n        'bash',\n        'nginx',\n        'docker',\n        'typescript',\n        'html',\n        'css',\n      ],\n    });\n    // const timer = setInterval(this.saveArticleLocal, 1000 * 60);\n    // this.timer = timer;\n    console.log(this.editor);\n\n    // this.editor.on('load', (e: any) => {\n    //   // console.log(e)\n    // });\n    // this.editor.on('focus', (e: any) => {\n    //   // console.log(e);\n    // });\n    // this.editor.on('change', (e: any) => {\n    //   // console.log(e);\n    //   // console.log(this.editor.getMarkdown());\n    // });\n  }\n  saveCardForCategory = async (card: CardData) => {\n    await categoryManage.addCardByUlid(this.category, card);\n    toast.success('saved success!');\n  };\n  saveCard = async () => {\n    const { title, desc, tags } = this;\n    const content: string = this.editor.getMarkdown();\n    console.log(title, desc);\n    if (!title && !desc && !content) {\n      toast.error('请输入完整信息');\n      return;\n    }\n    const _tags = tags.split(/[，,]/);\n    const _ulid = generateUlid();\n    const card: CardData = {\n      authName: 'hugh',\n      title,\n      desc,\n      tags: _tags,\n      type: 'client',\n      ulid: _ulid,\n      date: +new Date(),\n      content,\n    };\n    await this.saveCardForCategory(card);\n    this.toHome();\n  };\n  toHome = () => {\n    const { history } = this.props;\n    history.goBack();\n  };\n  titleHandler = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.title = e.target.value;\n  };\n  descHandler = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.desc = e.target.value;\n  };\n  tagsHandler = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.tags = e.target.value;\n  };\n  render() {\n    return (\n      <PageContainer>\n        <MainContainer>\n          <CardFormContainer>\n            <CardForm\n              titleHandler={this.titleHandler}\n              descHandler={this.descHandler}\n              tagsHandler={this.tagsHandler}\n              defaultCategory={this.prevCategory}\n            />\n          </CardFormContainer>\n          <EditorContainer ref={this.container} />\n          <FooterContainer>\n            <SaveButton text='保存' onClick={this.saveCard} />\n          </FooterContainer>\n        </MainContainer>\n      </PageContainer>\n    );\n  }\n}\n"],"sourceRoot":""}