{"version":3,"sources":["pages/Home.tsx","utils/categoryManage.ts"],"names":["PageContainer","styled","main","_templateObject","GridBox","div","_templateObject2","GridA","_templateObject3","GridB","_templateObject4","GridC","_templateObject5","GridD","_templateObject6","GridDRight","_templateObject7","AvatarBox","_templateObject8","FormBox","_templateObject9","prop","show","CardList","props","history","_useState","useState","_useState2","Object","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","cards","setCards","_useState3","_useState4","cardContentData","setCardContent","_useState5","_useState6","selectIndex","setSelectIndex","_useState7","_useState8","categorys","setCategorys","_useState9","_useState10","categoryShow","setCategoryShow","_useState11","_useState12","loginShow","setLoginShow","_useState13","_useState14","loginFormType","setLoginFormType","_useState15","_useState16","loginStatus","setLoginStatus","saveCategoryForLocal","_ref","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","a","mark","_callee","category","categorysLocal","wrap","_context","prev","next","localForage","getItem","sent","push","setItem","stop","_x","apply","this","arguments","addCategoryList","newCategorys","currCategorys","concat","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","length","saveCategory","_ref2","_callee2","len","_context2","_x2","setCurrCategoryCards","_ref4","_callee4","_context4","_x4","getCategorysFromLocal","_ref5","_callee5","_context5","categoryManage","getListFromLocal","categoryDel","_ref7","_callee7","index","currCategory","_categorys","_context7","removeLocalByUlid","ulid","_x6","categorySync","_ref8","_callee8","_context8","syncCardsByUlid","_x7","useEffect","console","log","react__WEBPACK_IMPORTED_MODULE_5___default","createElement","components__WEBPACK_IMPORTED_MODULE_8__","onSelect","onDel","onSync","onHide","onSuccess","type","name","onClick","onClickLogin","onClickSignIn","itemClick","item","onSave","pathname","state","toast","error","_Users_ziyue_workspace_card_study_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","abrupt","getLocalByUlid","categoryLocal","_callee3","_context3","_index","findIndex","val","splice","find","repaceCategoryByUlid","_callee6","newCategory","_categoryIndex","_context6","serverPromise","serverData","serverCategory","Api","syncCategory","json","data","card","__webpack_exports__","getLocalCardsByUlid","removeCardsByUlid","addCardByUlid"],"mappings":"k6DAiBA,IAAMA,EAAgBC,IAAOC,KAAVC,KAMbC,EAAUH,IAAOI,IAAVC,KASPC,EAAQN,IAAOI,IAAVG,KAGLC,EAAQR,IAAOI,IAAVK,KASLC,EAAQV,IAAOI,IAAVO,KAKLC,EAAQZ,IAAOI,IAAVS,KAYLC,EAAad,IAAOI,IAAVW,KAMVC,EAAYhB,IAAOI,IAAVa,KAITC,EAAUlB,IAAOI,IAAVe,IAGF,SAACC,GAAD,OAAgBA,EAAKC,KAAO,QAAU,KAElC,SAACD,GAAD,OACXA,EAAKC,KAAO,gBAAkB,sBAyLnBC,UAtLE,SAACC,GAA+B,IACvCC,EAAYD,EAAZC,QADuCC,EAErBC,qBAFqBC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GAExCK,EAFwCH,EAAA,GAEjCI,EAFiCJ,EAAA,GAAAK,EAGLN,qBAHKO,EAAAL,OAAAC,EAAA,EAAAD,CAAAI,EAAA,GAGxCE,EAHwCD,EAAA,GAGvBE,EAHuBF,EAAA,GAAAG,EAITV,oBAAU,GAJDW,EAAAT,OAAAC,EAAA,EAAAD,CAAAQ,EAAA,GAIxCE,EAJwCD,EAAA,GAI3BE,EAJ2BF,EAAA,GAAAG,EAMbd,mBADK,IALQe,EAAAb,OAAAC,EAAA,EAAAD,CAAAY,EAAA,GAMxCE,EANwCD,EAAA,GAM7BE,EAN6BF,EAAA,GAAAG,EAOPlB,oBAAS,GAPFmB,EAAAjB,OAAAC,EAAA,EAAAD,CAAAgB,EAAA,GAOxCE,EAPwCD,EAAA,GAO1BE,EAP0BF,EAAA,GAAAG,EAQbtB,oBAAS,GARIuB,EAAArB,OAAAC,EAAA,EAAAD,CAAAoB,EAAA,GAQxCE,EARwCD,EAAA,GAQ7BE,EAR6BF,EAAA,GAAAG,EASL1B,mBAAS,SATJ2B,EAAAzB,OAAAC,EAAA,EAAAD,CAAAwB,EAAA,GASxCE,EATwCD,EAAA,GASzBE,EATyBF,EAAA,GAAAG,EAUT9B,oBAAS,GAVA+B,EAAA7B,OAAAC,EAAA,EAAAD,CAAA4B,EAAA,GAUxCE,EAVwCD,EAAA,GAU3BE,EAV2BF,EAAA,GA8BzCG,EAAoB,eAAAC,EAAAjC,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAAC,EAAOC,GAAP,IAAAC,EAAA,OAAAL,EAAAC,EAAAK,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACgBC,IAAYC,QAAQ,aADpC,cACvBN,EADuBE,EAAAK,MAGzBP,EAAeQ,KAAKT,GAEpBC,EAAiB,CAACD,GALOG,EAAAE,KAAA,EAOrBC,IAAYI,QAAQ,YAAaT,GAPZ,wBAAAE,EAAAQ,SAAAZ,MAAH,gBAAAa,GAAA,OAAAlB,EAAAmB,MAAAC,KAAAC,YAAA,GASpBC,GAAkB,SAACC,GACvB,IAAMC,EAAa,GAAAC,OAAA1D,OAAA2D,EAAA,EAAA3D,CAAOc,GAAPd,OAAA2D,EAAA,EAAA3D,CAAqBwD,IAExC,OADAzC,EAAa0C,GACNA,EAAcG,QAEjBC,GAAY,eAAAC,EAAA9D,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAA0B,EAAOxB,GAAP,IAAAyB,EAAA,OAAA7B,EAAAC,EAAAK,KAAA,SAAAwB,GAAA,cAAAA,EAAAtB,KAAAsB,EAAArB,MAAA,cAAAqB,EAAArB,KAAA,EACbZ,EAAqBO,GADR,OAEbyB,EAAMT,GAAgB,CAAChB,IAC7B5B,EAAeqD,EAAM,GACrB7C,GAAgB,GAJG,wBAAA8C,EAAAf,SAAAa,MAAH,gBAAAG,GAAA,OAAAJ,EAAAV,MAAAC,KAAAC,YAAA,GAeZa,GAAoB,eAAAC,EAAApE,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAAgC,EAAO9B,GAAP,OAAAJ,EAAAC,EAAAK,KAAA,SAAA6B,GAAA,cAAAA,EAAA3B,KAAA2B,EAAA1B,MAAA,OACvBL,EAASrC,OACXC,EAASoC,EAASrC,OAFO,wBAAAoE,EAAApB,SAAAmB,MAAH,gBAAAE,GAAA,OAAAH,EAAAhB,MAAAC,KAAAC,YAAA,GAKpBkB,GAAqB,eAAAC,EAAAzE,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAAqC,IAAA,IAAAlC,EAAA,OAAAL,EAAAC,EAAAK,KAAA,SAAAkC,GAAA,cAAAA,EAAAhC,KAAAgC,EAAA/B,MAAA,cAAA+B,EAAA/B,KAAA,EACegC,IAAeC,mBAD9B,QACxBrC,EADwBmC,EAAA5B,MAETa,OAAS,IAC1BL,GAAgBf,GAChB7B,EAAe,IAJW,wBAAAgE,EAAAzB,SAAAwB,MAAH,yBAAAD,EAAArB,MAAAC,KAAAC,YAAA,GAiBrBwB,GAAW,eAAAC,EAAA/E,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAA2C,EAAOC,GAAP,IAAAC,EAAAC,EAAA,OAAAhD,EAAAC,EAAAK,KAAA,SAAA2C,GAAA,cAAAA,EAAAzC,KAAAyC,EAAAxC,MAAA,YACZsC,EAAepE,EAAUmE,IADb,CAAAG,EAAAxC,KAAA,eAAAwC,EAAAxC,KAAA,EAGSgC,IAAeS,kBACtCH,EAAaI,MAJC,QAGVH,EAHUC,EAAArC,QAOdhC,EAAaoE,GACbxE,EAAesE,EAAQ,IART,wBAAAG,EAAAlC,SAAA8B,MAAH,gBAAAO,GAAA,OAAAR,EAAA3B,MAAAC,KAAAC,YAAA,GAYXkC,GAAY,eAAAC,EAAAzF,OAAAkC,EAAA,EAAAlC,CAAAmC,EAAAC,EAAAC,KAAG,SAAAqD,EAAOT,GAAP,IAAAC,EAAA,OAAA/C,EAAAC,EAAAK,KAAA,SAAAkD,GAAA,cAAAA,EAAAhD,KAAAgD,EAAA/C,MAAA,OACbsC,EAAepE,EAAUmE,GAC/BL,IAAegB,gBAAgBV,EAAaI,MAFzB,wBAAAK,EAAAzC,SAAAwC,MAAH,gBAAAG,GAAA,OAAAJ,EAAArC,MAAAC,KAAAC,YAAA,GAyClB,OAXAwC,oBAAU,WACRtB,KAZc3B,IAAYC,QAAQ,UAEhCf,GAAe,IAYhB,IACH+D,oBAAU,WACR,IAAMZ,EAAepE,EAAUJ,GAC/BqF,QAAQC,IAAId,GACRA,GACFf,GAAqBe,IAEtB,CAACxE,IAEFuF,EAAA7D,EAAA8D,cAAC/H,EAAD,KACE8H,EAAA7D,EAAA8D,cAACC,EAAA,EAAe7F,GAChB2F,EAAA7D,EAAA8D,cAAC3H,EAAD,KACE0H,EAAA7D,EAAA8D,cAACxH,EAAD,KACEuH,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CACErF,UAAWA,EACXJ,YAAaA,EACb0F,SAnEa,SAACnB,GACtBc,QAAQC,IAAIf,GACZ1E,EAAe,IACfI,EAAesE,IAiEPoB,MAAOvB,GACPwB,OAAQd,MAGZS,EAAA7D,EAAA8D,cAACtH,EAAD,KACEqH,EAAA7D,EAAA8D,cAAC5G,EAAD,CAASG,KAAM6B,GACb2E,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CACEI,OAjCU,WACpBhF,GAAa,IAiCHiF,UAnDiB,WAC3BzE,GAAe,IAmDL0E,KAAM/E,KAGVuE,EAAA7D,EAAA8D,cAAChH,EAAD,MACIoC,GAAa2E,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CAAcO,KAAK,eAAKC,QApC5B,WACnB/G,EAAQoD,KAAK,YAoCLiD,EAAA7D,EAAA8D,cAAC9G,EAAD,KACE6G,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CACES,aAxDI,WAChBjF,EAAiB,SACjBJ,GAAa,IAuDDsF,cArDK,WACjBlF,EAAiB,UACjBJ,GAAa,IAoDDO,YAAaA,OAKrBmE,EAAA7D,EAAA8D,cAACpH,EAAD,KACEmH,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CAAWjG,MAAOA,EAAO4G,UA5Jf,SAACC,GACjBhB,QAAQC,IAAIe,GACZxG,EAAewG,OA4JXd,EAAA7D,EAAA8D,cAAClH,EAAD,KACEiH,EAAA7D,EAAA8D,cAAC5G,EAAD,CAASG,KAAMyB,GACb+E,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CAAca,OAAQnD,GAAc0C,OAzHrB,WACvBpF,GAAgB,OA0HV8E,EAAA7D,EAAA8D,cAAChH,EAAD,KACE+G,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CAAcO,KAAK,2BAAOC,QA/Jb,WACrBZ,QAAQC,IAAI,4BACZ7E,GAAgB,MA8JR8E,EAAA7D,EAAA8D,cAACC,EAAA,EAAD,CAAcO,KAAK,2BAAOC,QA5JjB,WACjB,IAAMzB,EAAepE,EAAUJ,GAC3BwE,EACFtF,EAAQoD,KAAK,CACXiE,SAAU,SACVC,MAAO,CAAE3E,SAAU2C,EAAaI,KAAMmB,KAAMvB,EAAauB,QAG3DU,IAAMC,MAAM,gJCvGHvC,8EAAf,SAAAvC,IAAA,IAAAE,EAAA,OAAA6E,EAAAjF,EAAAK,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAC+CC,IAAYC,QAAQ,aADnE,cACQN,EADRE,EAAAK,KAAAL,EAAA4E,OAAA,SAES9E,GAAkB,IAF3B,wBAAAE,EAAAQ,SAAAZ,sCAIeiF,+EAAf,SAAAxD,EAA8BuB,GAA9B,IAAAkC,EAAA,OAAAH,EAAAjF,EAAAK,KAAA,SAAAwB,GAAA,cAAAA,EAAAtB,KAAAsB,EAAArB,MAAA,cAAAqB,EAAArB,KAAA,EAC4CC,IAAYC,QAAQwC,GADhE,cACQkC,EADRvD,EAAAlB,KAAAkB,EAAAqD,OAAA,SAESE,GAFT,wBAAAvD,EAAAf,SAAAa,wEAIA,SAAA0D,EAAmCnC,GAAnC,IAAAkC,EAAA,OAAAH,EAAAjF,EAAAK,KAAA,SAAAiF,GAAA,cAAAA,EAAA/E,KAAA+E,EAAA9E,MAAA,cAAA8E,EAAA9E,KAAA,EAC4C2E,EAAejC,GAD3D,cACQkC,EADRE,EAAA3E,KAEEgD,QAAQC,IAAIwB,GAFdE,EAAAJ,OAAA,SAGUE,GAAiBA,EAActH,OAAU,IAHnD,wBAAAwH,EAAAxE,SAAAuE,wEAKA,SAAApD,EAAiCiB,GAAjC,IAAA9C,EAAAmF,EAAA,OAAAN,EAAAjF,EAAAK,KAAA,SAAA6B,GAAA,cAAAA,EAAA3B,KAAA2B,EAAA1B,MAAA,cAAA0B,EAAA1B,KAAA,EAC+CiC,IAD/C,UACQrC,EADR8B,EAAAvB,QAEQ4E,EAASnF,EAAeoF,UAAU,SAAAC,GAAG,OAAIA,EAAIvC,OAASA,MAC9C,GAHhB,CAAAhB,EAAA1B,KAAA,eAIIJ,EAAesF,OAAOH,EAAQ,GAJlCrD,EAAA1B,KAAA,EAKUC,IAAYI,QAAQ,YAAaT,GAL3C,cAAA8B,EAAAgD,OAAA,SAMW9E,GANX,cAAA8B,EAAAgD,OAAA,SAQS,MART,yBAAAhD,EAAApB,SAAAmB,wEAUA,SAAAK,EAAiCY,GAAjC,IAAA9C,EAAA0C,EAAA,OAAAmC,EAAAjF,EAAAK,KAAA,SAAAkC,GAAA,cAAAA,EAAAhC,KAAAgC,EAAA/B,MAAA,cAAA+B,EAAA/B,KAAA,EAC+CiC,IAD/C,UACQrC,EADRmC,EAAA5B,OAEQmC,EAAe1C,EAAeuF,KAAK,SAAAF,GAAG,OAAIA,EAAIvC,OAASA,KAF/D,CAAAX,EAAA/B,KAAA,eAIIsC,EAAahF,MAAQ,GAJzByE,EAAA/B,KAAA,EAKUC,IAAYI,QAAQ,YAAaT,GAL3C,wBAAAmC,EAAAzB,SAAAwB,sCAQesD,mFAAf,SAAAC,EACE3C,EACA4C,EACApH,GAHF,IAAAqE,EAAAgD,EAAA,OAAAd,EAAAjF,EAAAK,KAAA,SAAA2F,GAAA,cAAAA,EAAAzF,KAAAyF,EAAAxF,MAAA,UAKMuC,EAAarE,EACZA,EANP,CAAAsH,EAAAxF,KAAA,eAAAwF,EAAAxF,KAAA,EAOuBiC,IAPvB,OAOIM,EAPJiD,EAAArF,KAAA,WASMoC,EATN,CAAAiD,EAAAxF,KAAA,eAUUuF,EAAiBhD,EAAWyC,UAAU,SAAAC,GAAG,OAAIA,EAAIvC,OAASA,MAC1C,GAX1B,CAAA8C,EAAAxF,KAAA,gBAYMuC,EAAWgD,GAAkBD,EAZnCE,EAAAxF,KAAA,GAaYC,IAAYI,QAAQ,YAAakC,GAb7C,yBAAAiD,EAAAlF,SAAA+E,wEAsBA,SAAAjD,EAA+BM,GAA/B,IAAA9C,EAAA0C,EAAAmD,EAAAC,EAAAC,EAAA,OAAAlB,EAAAjF,EAAAK,KAAA,SAAA2C,GAAA,cAAAA,EAAAzC,KAAAyC,EAAAxC,MAAA,cAAAwC,EAAAxC,KAAA,EAC+CiC,IAD/C,UACQrC,EADR4C,EAAArC,OAEQmC,EAAe1C,EAAeuF,KAAK,SAAAF,GAAG,OAAIA,EAAIvC,OAASA,KAF/D,CAAAF,EAAAxC,KAAA,gBAAAwC,EAAAxC,KAAA,EAIgC4F,IAAIC,aAAavD,GAJjD,cAIUmD,EAJVjD,EAAArC,KAAAqC,EAAAxC,KAAA,GAK6ByF,EAAcK,OAL3C,WAKUJ,EALVlD,EAAArC,OAMUwF,EAAiBD,EAAWK,MANtC,CAAAvD,EAAAxC,KAAA,gBAAAwC,EAAAxC,KAAA,GAQYoF,EAAqB1C,EAAMiD,EAAgB/F,GARvD,yBAAA4C,EAAAlC,SAAA8B,wEAmBA,SAAAU,EAA6BJ,EAAcsD,GAA3C,IAAApG,EAAA0C,EAAA,OAAAmC,EAAAjF,EAAAK,KAAA,SAAAkD,GAAA,cAAAA,EAAAhD,KAAAgD,EAAA/C,MAAA,cAAA+C,EAAA/C,KAAA,EAC+CiC,IAD/C,UACQrC,EADRmD,EAAA5C,OAEQmC,EAAe1C,EAAeuF,KAAK,SAAAF,GAAG,OAAIA,EAAIvC,OAASA,KAF/D,CAAAK,EAAA/C,KAAA,gBAIIsC,EAAahF,MAAM8C,KAAK4F,GAJ5BjD,EAAA/C,KAAA,EAKUC,IAAYI,QAAQ,YAAaT,GAL3C,OAAAmD,EAAA/C,KAAA,wBAAA+C,EAAA2B,OAAA,SAOW,MAPX,yBAAA3B,EAAAzC,SAAAwC,6BAUemD,EAAA,GACbhE,mBACA0C,iBACAuB,gEACAzD,8DACA0D,8DACAnD,4DACAoD","file":"static/js/7.b295727a.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport styled from 'styled-components';\nimport localForage from 'localforage';\nimport {\n  ContentBox,\n  CustomButton,\n  CardsHorz,\n  CategoryList,\n  CategoryForm,\n  LoginForm,\n  Avatar,\n} from 'components';\nimport { ItemData, CategoryData } from 'types';\nimport categoryManage from 'utils/categoryManage';\nimport { toast } from 'react-toastify';\n\nconst PageContainer = styled.main`\n  width: 100vw;\n  height: 100vh;\n  background: #000;\n  position: relative;\n`;\nconst GridBox = styled.div`\n  width: 100%;\n  height: 100%;\n  display: grid;\n  overflow: hidden;\n  grid-template-columns: 200px 1fr;\n  grid-template-rows: 1fr 300px 1fr;\n  grid-template-areas: 'a b' 'a c' 'a d';\n`;\nconst GridA = styled.div`\n  grid-area: a;\n`;\nconst GridB = styled.div`\n  grid-area: b;\n  border-left: 2px solid var(--color-3);\n  border-bottom: 2px solid var(--color-3);\n  box-shadow: 0 0 10px 0 var(--color-3) inset;\n  border-bottom-left-radius: 10px;\n  overflow: hidden;\n  display: flex;\n`;\nconst GridC = styled.div`\n  width: 100%;\n  min-width: 100%;\n  grid-area: c;\n`;\nconst GridD = styled.div`\n  grid-area: d;\n  border-left: 2px solid var(--color-3);\n  border-top: 2px solid var(--color-3);\n  box-shadow: 0 0 10px 0 var(--color-3) inset;\n  border-top-left-radius: 10px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px;\n`;\nconst GridDRight = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n`;\nconst AvatarBox = styled.div`\n  margin: 0 100px;\n`;\n\nconst FormBox = styled.div`\n  border-top-left-radius: 10px;\n  height: 100%;\n  width: ${(prop: any) => (prop.show ? '300px' : '0')};\n  overflow: hidden;\n  transform: ${(prop: any) =>\n    prop.show ? 'translateX(0)' : 'translateX(-120%)'};\n  transition: transform 0.5s;\n`;\nconst CardList = (props: RouteComponentProps) => {\n  const { history } = props;\n  const [cards, setCards] = useState();\n  const [cardContentData, setCardContent] = useState();\n  const [selectIndex, setSelectIndex] = useState(-1);\n  const initCaregeorys: CategoryData[] = [];\n  const [categorys, setCategorys] = useState(initCaregeorys);\n  const [categoryShow, setCategoryShow] = useState(false);\n  const [loginShow, setLoginShow] = useState(false);\n  const [loginFormType, setLoginFormType] = useState('login');\n  const [loginStatus, setLoginStatus] = useState(false);\n  const itemClick = (item: ItemData) => {\n    console.log(item);\n    setCardContent(item);\n  };\n  const createCategory = () => {\n    console.log('新建分类');\n    setCategoryShow(true);\n  };\n  const createCard = () => {\n    const currCategory = categorys[selectIndex];\n    if (currCategory) {\n      history.push({\n        pathname: 'editor',\n        state: { category: currCategory.ulid, type: currCategory.type },\n      });\n    } else {\n      toast.error('请先新建分类');\n    }\n  };\n  const saveCategoryForLocal = async (category: CategoryData) => {\n    let categorysLocal: CategoryData[] = await localForage.getItem('categorys');\n    if (categorysLocal) {\n      categorysLocal.push(category);\n    } else {\n      categorysLocal = [category];\n    }\n    await localForage.setItem('categorys', categorysLocal);\n  };\n  const addCategoryList = (newCategorys: CategoryData[]) => {\n    const currCategorys = [...categorys, ...newCategorys];\n    setCategorys(currCategorys);\n    return currCategorys.length;\n  };\n  const saveCategory = async (category: CategoryData) => {\n    await saveCategoryForLocal(category);\n    const len = addCategoryList([category]);\n    setSelectIndex(len - 1);\n    setCategoryShow(false);\n  };\n  const hideCategoryForm = () => {\n    setCategoryShow(false);\n  };\n  const getCardsFromLocal = async (category: CategoryData) => {\n    const localCards: any[] = await categoryManage.getLocalCardsByUlid(\n      category.ulid\n    );\n    return localCards;\n  };\n  const setCurrCategoryCards = async (category: CategoryData) => {\n    if (category.cards) {\n      setCards(category.cards);\n    }\n  };\n  const getCategorysFromLocal = async () => {\n    let categorysLocal: CategoryData[] = await categoryManage.getListFromLocal();\n    if (categorysLocal.length > 0) {\n      addCategoryList(categorysLocal);\n      setSelectIndex(0);\n    }\n  };\n  const getCategoryFromLocal = async (ulid: string) => {\n    let categorysLocal: CategoryData[] = await localForage.getItem(ulid);\n    return categorysLocal || [];\n  };\n  const categorySelect = (index: number) => {\n    console.log(index);\n    setCardContent('');\n    setSelectIndex(index);\n    // getCardsFromLocal(categorys[index]);\n  };\n  const categoryDel = async (index: number) => {\n    const currCategory = categorys[index];\n    if (currCategory) {\n      const _categorys = await categoryManage.removeLocalByUlid(\n        currCategory.ulid\n      );\n      if (_categorys) {\n        setCategorys(_categorys);\n        setSelectIndex(index - 1);\n      }\n    }\n  };\n  const categorySync = async (index: number) => {\n    const currCategory = categorys[index];\n    categoryManage.syncCardsByUlid(currCategory.ulid);\n  };\n  const removeLocalCards = async () => {\n    console.log('remove');\n  };\n  const loginOrSignInSuccess = () => {\n    setLoginStatus(true);\n  };\n  const showLogin = () => {\n    setLoginFormType('login');\n    setLoginShow(true);\n  };\n  const showSignin = () => {\n    setLoginFormType('signin');\n    setLoginShow(true);\n  };\n  const hasLogin = () => {\n    const token = localForage.getItem('token');\n    if (token) {\n      setLoginStatus(true);\n    }\n  };\n  const hideLoginForm = () => {\n    setLoginShow(false);\n  };\n  const toSearchList = () => {\n    history.push('/list');\n  };\n  useEffect(() => {\n    getCategorysFromLocal();\n    hasLogin();\n  }, []);\n  useEffect(() => {\n    const currCategory = categorys[selectIndex];\n    console.log(currCategory);\n    if (currCategory) {\n      setCurrCategoryCards(currCategory);\n    }\n  }, [selectIndex]);\n  return (\n    <PageContainer>\n      <ContentBox {...cardContentData} />\n      <GridBox>\n        <GridA>\n          <CategoryList\n            categorys={categorys}\n            selectIndex={selectIndex}\n            onSelect={categorySelect}\n            onDel={categoryDel}\n            onSync={categorySync}\n          />\n        </GridA>\n        <GridB>\n          <FormBox show={loginShow}>\n            <LoginForm\n              onHide={hideLoginForm}\n              onSuccess={loginOrSignInSuccess}\n              type={loginFormType}\n            />\n          </FormBox>\n          <GridDRight>\n            {!loginShow && <CustomButton name='搜索' onClick={toSearchList} />}\n            <AvatarBox>\n              <Avatar\n                onClickLogin={showLogin}\n                onClickSignIn={showSignin}\n                loginStatus={loginStatus}\n              />\n            </AvatarBox>\n          </GridDRight>\n        </GridB>\n        <GridC>\n          <CardsHorz cards={cards} itemClick={itemClick} />\n        </GridC>\n        <GridD>\n          <FormBox show={categoryShow}>\n            <CategoryForm onSave={saveCategory} onHide={hideCategoryForm} />\n          </FormBox>\n          <GridDRight>\n            <CustomButton name='新建分类' onClick={createCategory} />\n            <CustomButton name='新建卡片' onClick={createCard} />\n          </GridDRight>\n        </GridD>\n      </GridBox>\n    </PageContainer>\n  );\n};\nexport default CardList;\n","import localForage from 'localforage';\nimport { CardData, CategoryData } from '../types';\nimport Api from 'api';\n\nasync function getListFromLocal() {\n  const categorysLocal: CategoryData[] = await localForage.getItem('categorys');\n  return categorysLocal || [];\n}\nasync function getLocalByUlid(ulid: string) {\n  const categoryLocal: CategoryData = await localForage.getItem(ulid);\n  return categoryLocal;\n}\nasync function getLocalCardsByUlid(ulid: string) {\n  const categoryLocal: CategoryData = await getLocalByUlid(ulid);\n  console.log(categoryLocal);\n  return (categoryLocal && categoryLocal.cards) || [];\n}\nasync function removeLocalByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const _index = categorysLocal.findIndex(val => val.ulid === ulid);\n  if (_index > -1) {\n    categorysLocal.splice(_index, 1);\n    await localForage.setItem('categorys', categorysLocal);\n    return categorysLocal;\n  }\n  return null;\n}\nasync function removeCardsByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    currCategory.cards = [];\n    await localForage.setItem('categorys', categorysLocal);\n  }\n}\nasync function repaceCategoryByUlid(\n  ulid: string,\n  newCategory: CategoryData,\n  categorys?: CategoryData[]\n) {\n  let _categorys = categorys;\n  if (!categorys) {\n    _categorys = await getListFromLocal();\n  }\n  if (_categorys) {\n    const _categoryIndex = _categorys.findIndex(val => val.ulid === ulid);\n    if (_categoryIndex > -1) {\n      _categorys[_categoryIndex] = newCategory;\n      await localForage.setItem('categorys', _categorys);\n    }\n  }\n}\n/**\n * 和服务器同步卡片，只同步本人创建的分类\n *\n * @param {string} ulid 分类uLid\n */\nasync function syncCardsByUlid(ulid: string) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    const serverPromise = await Api.syncCategory(currCategory);\n    const serverData = await serverPromise.json();\n    const serverCategory = serverData.data;\n    if (serverCategory) {\n      await repaceCategoryByUlid(ulid, serverCategory, categorysLocal);\n    }\n  }\n}\n/**\n * 通过ulid添加卡片到本地\n *\n * @param {string} ulid\n * @param {CardData} card\n * @returns\n */\nasync function addCardByUlid(ulid: string, card: CardData) {\n  const categorysLocal: CategoryData[] = await getListFromLocal();\n  const currCategory = categorysLocal.find(val => val.ulid === ulid);\n  if (currCategory) {\n    currCategory.cards.push(card);\n    await localForage.setItem('categorys', categorysLocal);\n  } else {\n    return null;\n  }\n}\nexport default {\n  getListFromLocal,\n  getLocalByUlid,\n  getLocalCardsByUlid,\n  removeLocalByUlid,\n  removeCardsByUlid,\n  syncCardsByUlid,\n  addCardByUlid,\n};\n"],"sourceRoot":""}